{
  "root": "Query",
  "grammar": {
    "Query": [
      ["Expr", "$"],
      ["Vars", ";", "Expr", "$"]
    ],

    "Vars": [
      ["Vars", ";", "Var"],
      ["Var"]
    ],

    "Var": [
      ["ident", "from", "Path"]
    ],

    "Expr": [
      ["Variant"],
      ["Numeric"],
      ["Factor"],
      ["Term"],
      ["Concat"],
      ["Comparison"],
      ["And"],
      ["Or"],
      ["Cond"],
      ["Assign"],
      ["Object"],
      ["Array"],
      ["Boolean"],
      ["string"],
      ["null"],
      ["Unset"]
    ],

    "Assign": [
      ["Path", "=", "Expr"]
    ],

    "Cond": [
      ["PreCond", "Expr", ":", "Expr"]
    ],

    "Unset": [
      ["delete", "Path"]
    ],

    "PreCond": [
      ["Or", "?"],
      ["And", "?"],
      ["Comparison", "?"],
      ["Variant", "?"],
      ["Factor", "?"],
      ["Term", "?"],
      ["Concat", "?"],
      ["string", "?"],
      ["Numeric", "?"],
      ["Object", "?"],
      ["Array", "?"],
      ["Boolean", "?"],
      ["null", "?"]
    ],

    "Or": [
      ["PreOr", "LogicalOp"],
      ["PreOr", "And"]
    ],

    "PreOr": [
      ["Or", "||"],
      ["And", "||"],
      ["Comparison", "||"],
      ["Variant", "||"],
      ["Factor", "||"],
      ["Term", "||"],
      ["Concat", "||"],
      ["string", "||"],
      ["Numeric", "||"],
      ["Object", "||"],
      ["Array", "||"],
      ["Boolean", "||"],
      ["null", "||"]
    ],

    "And": [
      ["PreAnd", "LogicalOp"]
    ],

    "PreAnd": [
      ["And", "&&"],
      ["Comparison", "&&"],
      ["Variant", "&&"],
      ["Factor", "&&"],
      ["Term", "&&"],
      ["Concat", "&&"],
      ["string", "&&"],
      ["Numeric", "&&"],
      ["Object", "&&"],
      ["Array", "&&"],
      ["Boolean", "&&"],
      ["null", "&&"]
    ],

    "LogicalOp": [
      ["Comparison"],
      ["Variant"],
      ["Factor"],
      ["Term"],
      ["Concat"],
      ["string"],
      ["Numeric"],
      ["Object"],
      ["Array"]
    ],

    "Comparison": [
      ["Match"],
      ["Eq"],
      ["Neq"],
      ["SNeq"],
      ["Seq"],
      ["Gt"],
      ["Gte"],
      ["Lt"],
      ["Lte"]
    ],

    "Match": [
      ["PreMatch", "MatchOp"]
    ],

    "PreMatch": [
      ["Variant", "=~"],
      ["Factor", "=~"],
      ["Term", "=~"],
      ["Concat", "=~"],
      ["string", "=~"],
      ["Numeric", "=~"]
    ],

    "MatchOp": [
      ["string"],
      ["regex"]
    ],

    "Seq": [
      ["PreSeq", "EqOp"]
    ],

    "PreSeq": [
      ["Variant", "==="],
      ["Factor", "==="],
      ["Term", "==="],
      ["Concat", "==="],
      ["string", "==="],
      ["Numeric", "==="],
      ["Object", "==="],
      ["Array", "==="],
      ["Boolean", "==="],
      ["null", "==="]
    ],

    "Eq": [
      ["PreEq", "EqOp"]
    ],

    "PreEq": [
      ["Variant", "=="],
      ["Factor", "=="],
      ["Term", "=="],
      ["Concat", "=="],
      ["string", "=="],
      ["Numeric", "=="],
      ["Object", "=="],
      ["Array", "=="],
      ["Boolean", "=="],
      ["null", "=="]
    ],

    "Neq": [
      ["PreNeq", "EqOp"]
    ],

    "PreNeq": [
      ["Variant", "!="],
      ["Factor", "!="],
      ["Term", "!="],
      ["Concat", "!="],
      ["string", "!="],
      ["Numeric", "!="],
      ["Object", "!="],
      ["Array", "!="],
      ["Boolean", "!="],
      ["null", "!="]
    ],

    "SNeq": [
      ["SPreNeq", "EqOp"]
    ],

    "SPreNeq": [
      ["Variant", "!=="],
      ["Factor", "!=="],
      ["Term", "!=="],
      ["Concat", "!=="],
      ["string", "!=="],
      ["Numeric", "!=="],
      ["Object", "!=="],
      ["Array", "!=="],
      ["Boolean", "!=="],
      ["null", "!=="]
    ],

    "EqOp": [
      ["Variant"],
      ["Factor"],
      ["Term"],
      ["Concat"],
      ["string"],
      ["Numeric"],
      ["Object"],
      ["Array"],
      ["Boolean"],
      ["null"]
    ],

    "Boolean": [
      ["true"],
      ["false"],
      ["Not"]
    ],

    "Not": [
      ["!", "Expr"]
    ],

    "Array": [
      ["[", "Params", "]"]
    ],

    "Object": [
      ["{", "Props", "}"]
    ],

    "Props": [
      ["Props", ",", "Prop"],
      ["Prop"]
    ],

    "Prop": [
      ["ident", ":", "Expr"]
    ],

    "Gt": [
      ["PreGt", "CompOp"]
    ],

    "PreGt": [
      ["Variant", ">"],
      ["Factor", ">"],
      ["Term", ">"],
      ["Concat", ">"],
      ["string", ">"],
      ["Numeric", ">"]
    ],

    "Gte": [
      ["PreGte", "CompOp"]
    ],

    "PreGte": [
      ["Variant", ">="],
      ["Factor", ">="],
      ["Term", ">="],
      ["Concat", ">="],
      ["string", ">="],
      ["Numeric", ">="]
    ],

    "Lt": [
      ["PreLt", "CompOp"]
    ],

    "PreLt": [
      ["Variant", "<"],
      ["Factor", "<"],
      ["Term", "<"],
      ["Concat", "<"],
      ["string", "<"],
      ["Numeric", "<"]
    ],

    "Lte": [
      ["PreLte", "CompOp"]
    ],

    "PreLte": [
      ["Variant", "<="],
      ["Factor", "<="],
      ["Term", "<="],
      ["Concat", "<="],
      ["string", "<="],
      ["Numeric", "<="]
    ],

    "CompOp": [
      ["Variant"],
      ["Factor"],
      ["Term"],
      ["Concat"],
      ["string"],
      ["Numeric"]
    ],

    "Concat": [
      ["Concat", "+", "ConcatOp"],
      ["string", "+", "ConcatOp"],
      ["PreAdd", "string"]
    ],

    "ConcatOp": [
      ["Factor"],
      ["Term"],
      ["Variant"],
      ["Numeric"]
    ],

    "Term": [
      ["Add"],
      ["Sub"]
    ],

    "Add": [
      ["PreAdd", "TermOp"]
    ],

    "Sub": [
      ["PreSub", "TermOp"]
    ],

    "PreSub": [
      ["Term", "-"],
      ["Factor", "-"],
      ["Variant", "-"],
      ["Numeric", "-"]
    ],

    "PreAdd": [
      ["Term", "+"],
      ["Factor", "+"],
      ["Variant", "+"],
      ["Numeric", "+"]
    ],

    "TermOp": [
      ["Factor"],
      ["Variant"],
      ["Numeric"]
    ],

    "Factor": [
      ["Mul"],
      ["Div"],
      ["Mod"]
    ],

    "Mul": [
      ["PreMul", "FactorOp"]
    ],

    "Div": [
      ["PreDiv", "FactorOp"]
    ],

    "Mod": [
      ["PreMod", "FactorOp"]
    ],

    "FactorOp": [
      ["Variant"],
      ["Numeric"]
    ],

    "PreMul": [
      ["Factor", "*"],
      ["Variant", "*"],
      ["Numeric", "*"]
    ],

    "PreDiv": [
      ["Factor", "/"],
      ["Variant", "/"],
      ["Numeric", "/"]
    ],

    "PreMod": [
      ["Factor", "%"],
      ["Variant", "%"],
      ["Numeric", "%"]
    ],

    "Variant": [
      ["Path"],
      ["RefIndex"],
      ["Call"],
      ["(", "Expr", ")"]
    ],

    "Call": [
      ["ident", "(", "Params", ")"]
    ],

    "Params": [
      ["Params", ",", "Expr"],
      ["Expr"]
    ],

    "Numeric": [
      ["PosNum"],
      ["NegNum"],
      ["Num"]
    ],

    "PosNum": [
      ["+", "Num"]
    ],

    "NegNum": [
      ["-", "Num"]
    ],

    "Num": [
      ["integer"],
      ["float"],
      ["percent"]
    ],

    "Path": [
      ["Dot"],
      ["Brace"],
      ["Filter"],
      ["Ref"],
      ["Root"],
      ["ident"]
    ],
    "Dot": [
      ["PreDot", "PostDot"],
      ["PreDot", "integer"]
    ],
    "Brace": [
      ["PreBrace", "PostDot", "]"],
      ["PreBrace", "integer", "]"]
    ],
    "Filter": [
      ["PreBrace", "]"],
      ["PreBrace", "Ranges", "]"]
    ],
    "PreDot": [
      ["Path", "."],
      ["."]
    ],
    "PreBrace": [
      ["Path", "["],
      [".", "["]
    ],
    "PostDot": [
      ["ident"],
      ["string"],
      ["RefIndex"],
      ["(", "Expr", ")"]
    ],
    "Ranges": [
      ["Ranges", ",", "RangeOp"],
      ["Ranges", ",", "Range"],
      ["RangeOp"],
      ["Range"]
    ],
    "Range": [
      ["RangeOp", "..", "RangeOp"]
    ],

    "RangeOp": [
      ["integer"],
      ["RefIndex"],
      ["(", "Expr", ")"]
    ],

    "Ref": [
      ["@", "ident"]
    ],
    "Root": [
      ["@"]
    ],
    "RefIndex": [
      ["@", "integer"],
      ["?"]
    ]
  }
}