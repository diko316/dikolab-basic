{
  "root": "JsonQuery",
  "grammar": {
    "JsonQuery": [
      ["Refs", "Stmt", "$"],
      ["Stmt", "$"]
    ],
    "Refs": [
      ["Refs", "Ref", ";"],
      ["Ref", ";"]
    ],
    "Ref": [
      ["ident", "from", "Stmt"]
    ],
    "Stmt": [
      ["Assignment"],
      ["CondTern"],
      ["Cond"]
    ],

    "Assignment": [
      ["JsonPath", "=", "Stmt"]
    ],

    "CondTern": [
      ["CondTern", "?", "CondOptions"],
      ["Cond", "?", "CondOptions"]
    ],

    "CondOptions": [
      ["Stmt", ":", "Stmt"]
    ],

    "Cond": [
      ["Or"],
      ["And"],
      ["Logical"]
    ],

    "Or": [
      ["Or", "||", "OrLeft"],
      ["And", "||", "OrLeft"],
      ["Logical", "||", "OrLeft"]
    ],

    "And": [
      ["And", "&&", "Logical"],
      ["Logical", "&&", "Logical"]
    ],

    "Logical": [
      ["Eq"],
      ["Neq"],
      ["Match"],
      ["Gt"],
      ["Gte"],
      ["Lt"],
      ["Lte"],
      ["Comp"]
    ],

    "Eq": [
      ["Comp", "==", "Comp"],
      ["Comp", "===", "Comp"]
    ],

    "Neq": [
      ["Comp", "!=", "Comp"],
      ["Comp", "!==", "Comp"]
    ],

    "Match": [
      ["Scalar", "~=", "Matcher"]
    ],

    "Matcher": [
      ["Scalar"],
      ["regex"]
    ],

    "Comp": [
      ["Object"],
      ["Array"],
      ["regex"],
      ["Boolean"],
      ["Scalar"]
    ],

    "Gt": [
      ["Scalar", ">", "Scalar"]
    ],

    "Gte": [
      ["Scalar", ">=", "Scalar"]
    ],

    "Lt": [
      ["Scalar", "<", "Scalar"]
    ],

    "Lte": [
      ["Scalar", "<=", "Scalar"]
    ],

    "Object": [
      ["{", "Props", "}"],
      ["{", "}"]
    ],

    "Props": [
      ["Props", ",", "PropsDef"],
      ["PropsDef"]
    ],

    "PropsDef": [
      ["ident", ":", "Stmt"]
    ],

    "Array": [
      ["[", "ArrayItems", "]"],
      ["[", "]"]
    ],

    "ArrayItems": [
      ["ArrayItems", ",", "Stmt"],
      ["Stmt"]
    ],

    "Boolean": [
      ["!", "Comp"],
      ["true"],
      ["false"]
    ],

    "Scalar": [
      ["Term"],
      ["Concat"],
      ["string"]
    ],

    "Concat": [
      ["Concat", "+", "Term"],
      ["Concat", "+", "string"],
      ["Term", "+", "string"],
      ["string", "+", "Term"]
    ],

    "Term": [
      ["Add"],
      ["Sub"],
      ["Factor"]
    ],

    "Add": [
      ["Term", "+", "Factor"]
    ],

    "Sub": [
      ["Term", "-", "Factor"]
    ],

    "Factor": [
      ["Mul"],
      ["Div"],
      ["Mod"],
      ["Numeric"],
      ["Variant"]
    ],

    "Mul": [
      ["Factor", "*", "Numeric"],
      ["Factor", "*", "Variant"]
    ],

    "Div": [
      ["Factor", "/", "Numeric"],
      ["Factor", "/", "Variant"]
    ],

    "Mod": [
      ["Factor", "%", "Numeric"],
      ["Factor", "%", "Variant"]
    ],

    "Variant": [
      ["(", "Stmt", ")"],
      ["Call"],
      ["JsonPath"]
    ],

    "Numeric": [
      ["Signed"],
      ["Number"]
    ],

    "Call": [
      ["ident", "(", "Params", ")"]
    ],

    "Params": [
      ["Params", ",", "Stmt"],
      ["Stmt"]
    ],

    "JsonPath": [
      ["JsonListify"],
      ["JsonFilter"],
      ["JsonAccess"],
      ["JsonProps"],
      ["Variable"],
      ["ident"]
    ],

    "JsonProps": [
      ["JsonPath", ".", "*"]
    ],
    "JsonListify": [
      ["JsonPath", "[", "]"]
    ],

    "JsonAccess": [
      ["JsonPath", ".", "JsonKey"],
      ["JsonPath", "[", "JsonKeyIndex", "]"]
    ],

    "JsonFilter": [
      ["JsonPath", "[", "JsonKeys", "]"]
    ],

    "JsonKey": [
      ["ident"],
      ["string"],
      ["JsonKeyIndex"]
    ],

    "JsonKeys": [
      ["JsonKeys", ",", "JsonKeyIndex"],
      ["JsonKeyIndex", ",", "JsonKeyIndex"]
    ],

    "JsonKeyIndex": [
      ["integer"],
      ["Variable"],
      ["(", "JsonPath", ")"]
    ],

    "Variable": [
      ["VarRef"],
      ["VarIndex"],
      ["Root"]
    ],

    "VarRef": [
      ["@", "ident"]
    ],

    "VarIndex": [
      ["@", "integer"],
      ["?"]
    ],

    "Root": [
      ["@"]
    ],

    "Signed": [
      ["-", "Number"],
      ["+", "Number"]
    ],

    "Number": [
      ["float"],
      ["integer"],
      ["percent"]
    ]
  }
}